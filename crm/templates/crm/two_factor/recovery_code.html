{% extends 'crm/base.html' %}

{% block title %}Kod odzyskiwania{% endblock %}

{% block content %}
<div class="container py-5">
    <div class="row justify-content-center">
        <div class="col-md-6">
            <div class="card shadow">
                <div class="card-header bg-success text-white">
                    <h4 class="mb-0"><i class="fas fa-key"></i> Nowy kod odzyskiwania</h4>
                </div>
                <div class="card-body">
                    <div class="alert alert-warning">
                        <i class="fas fa-exclamation-triangle"></i> <strong>WAŻNE:</strong> 
                        Zapisz ten kod odzyskiwania w bezpiecznym miejscu. Możesz go użyć raz, by odzyskać dostęp do konta, 
                        jeśli utracisz dostęp do swojej aplikacji uwierzytelniającej.
                    </div>
                    
                    <div class="my-4 p-4 bg-light rounded text-center">
                        <h5>Twój nowy kod odzyskiwania:</h5>
                        <div class="bg-white p-3 rounded border my-3">
                            <code class="user-select-all fs-4">{{ recovery_code }}</code>
                        </div>
                        
                        <button id="copyButton" class="btn btn-sm btn-secondary" onclick="copyRecoveryCode()">
                            <i class="fas fa-copy"></i> Kopiuj do schowka
                        </button>
                    </div>
                    
                    <div class="text-center mt-4">
                        <a href="{% url 'dashboard' %}" class="btn btn-primary">
                            <i class="fas fa-home"></i> Powrót do panelu głównego
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
function copyRecoveryCode() {
    const code = '{{ recovery_code }}';
    navigator.clipboard.writeText(code).then(function() {
        const btn = document.getElementById('copyButton');
        btn.innerHTML = '<i class="fas fa-check"></i> Skopiowano!';
        btn.classList.replace('btn-secondary', 'btn-success');
        
        setTimeout(function() {
            btn.innerHTML = '<i class="fas fa-copy"></i> Kopiuj do schowka';
            btn.classList.replace('btn-success', 'btn-secondary');
        }, 2000);
    });
}
</script>
{% endblock %}
